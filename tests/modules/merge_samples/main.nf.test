nextflow_process {

    name "Test Process MERGE_SAMPLES"
    script "modules/merge_samples/main.nf"
    process "MERGE_SAMPLES"

    test("step: atlas") {

        when {
            params {
                // define parameters here. Example:
                // outdir = "tests/results"
            }
            process {
                """
                // define inputs of the process here. Example:
                input[0] = "atlas"
                input[1] = Channel.of(params.pipelines_testdata_base_path + '/modules/limma/SRR536235_sample_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/SRR536237_sample_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/SRR620007_sample_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/SRR641696_sample_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/SRR1045638_sample_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/SRR1045641_sample_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/SRR1045707_sample_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/SRR536234_sample_mix.csv').collect()
                """
            }
        }

        then {
            assert process.success
            assert snapshot(process.out).match()
        }

    }

    test("step: celfie_atlas") {

        when {
            params {
                // define parameters here. Example:
                // outdir = "tests/results"
            }
            process {
                """
                // define inputs of the process here. Example:
                input[0] = "celfie_atlas"
                input[1] = Channel.of(params.pipelines_testdata_base_path + '/modules/limma/colon_1_sample_celfie_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/colon_2_sample_celfie_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/colon_3_sample_celfie_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/lung_1_sample_celfie_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/lung_2_sample_celfie_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/lung_3_sample_celfie_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/pancreas_1_sample_celfie_mix.csv',
                                    params.pipelines_testdata_base_path + '/modules/limma/pancreas_2_sample_celfie_mix.csv')
                """
            }
        }

        then {
            assert process.success
            assert snapshot(process.out).match()
        }
    }

    test("step: test") {

        when {
            params {
                // define parameters here. Example:
                // outdir = "tests/results"
            }
            process {
                """
                // define inputs of the process here. Example:
                input[0] = "test"
                input[1] = Channel.of(params.pipelines_testdata_base_path + 'modules/limma/SRR536238_sample_mix.csv',
                                    params.pipelines_testdata_base_path + 'modules/limma/SRR620008_sample_mix.csv',
                                    params.pipelines_testdata_base_path + 'modules/limma/SRR641695_sample_mix.csv')
                """
            }
        }

        then {
            assert process.success
            assert snapshot(process.out).match()
        }
    }

    test("step: test_celfie") {

        when {
            params {
                // define parameters here. Example:
                // outdir = "tests/results"
            }
            process {
                """
                // define inputs of the process here. Example:
                input[0] = "test_celfie"
                input[1] = Channel.of(params.pipelines_testdata_base_path + 'modules/limma/SRR536238_sample_celfie_mix.csv',
                                    params.pipelines_testdata_base_path + 'modules/limma/SRR620008_sample_celfie_mix.csv',
                                    params.pipelines_testdata_base_path + 'modules/limma/SRR641695_sample_celfie_mix.csv')
                """
            }
        }

        then {
            assert process.success
            assert snapshot(process.out).match()
        }
    }

}
